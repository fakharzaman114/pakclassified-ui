<section class="section-spacing">
    <div class="app-container">

        <!-- Dynamic Heading -->
        <div class="text-center mb-5">
            <h2 class="fw-bold mb-3">{{categoryName}} Listings</h2>
            <p class="text-muted" *ngIf="ads.length > 0">
                Browse all {{categoryName.toLowerCase()}} related advertisements available in our marketplace.
            </p>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Loading {{categoryName.toLowerCase()}} listings...</p>
        </div>

        <!-- Posts Section -->
        <div *ngIf="!isLoading && ads.length > 0; else noAds">
            <div class="row justify-content-center">
                <div class="col-12">
                    <div class="row g-4">
                        <div *ngFor="let ad of paginatedAds" class="col-12 col-sm-6 col-md-6 col-lg-4 col-xl-4">

                            <div class="post-card card shadow-sm h-100">

                                <!-- Image Section -->
                                <div class="position-relative">
                                    <img *ngIf="ad.images && ad.images.length > 0" [src]="ad.images[0].url"
                                        [alt]="ad.images[0].caption || ad.name" class="card-img-top post-image">

                                    <div *ngIf="!ad.images || ad.images.length === 0"
                                        class="no-image text-muted text-center py-5">
                                        <div class="fs-3">ðŸ“·</div>
                                        <small>No Image Available</small>
                                    </div>
                                </div>

                                <!-- Content Section -->
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title text-primary">{{ ad.name }}</h5>
                                    <p class="card-text fw-bold text-success">{{ ad.price | pkrCurrency }}</p>
                                    <p class="card-text text-muted">
                                        {{ getDescriptionText(ad.description) }}
                                    </p>

                                    <!-- Details -->
                                    <ul class="details-list">
                                        <li *ngIf="ad.cityArea">
                                            <span class="label">City Area:</span>
                                            <span class="value">
                                                {{ ad.cityArea.name }}
                                                <span *ngIf="ad.cityArea.city">({{ ad.cityArea.city.name }})</span>
                                            </span>
                                        </li>

                                        <li *ngIf="ad.subCategory">
                                            <span class="label">SubCategory:</span>
                                            <span class="value">{{ ad.subCategory.name }}</span>
                                        </li>

                                        <li *ngIf="ad.status">
                                            <span class="label">Status:</span>
                                            <span class="value">{{ ad.status.name }}</span>
                                        </li>

                                        <li *ngIf="ad.type">
                                            <span class="label">Type:</span>
                                            <span class="value">{{ ad.type.name }}</span>
                                        </li>

                                        <li *ngIf="ad.postedBy">
                                            <span class="label">Posted By:</span>
                                            <span class="value">{{ ad.postedBy.name }}</span>
                                        </li>

                                        <li>
                                            <span class="label">Views:</span>
                                            <span class="value">{{ ad.hits }}</span>
                                        </li>
                                    </ul>

                                    <!-- Tags -->
                                    <div *ngIf="ad.tags && ad.tags.length > 0" class="mt-3">
                                        <span *ngFor="let tag of ad.tags" class="badge bg-success me-1 mb-1">
                                            {{ tag.name }}
                                        </span>
                                    </div>

                                    <!-- View Details Button -->
                                    <div class="mt-auto pt-3">
                                        <button class="btn btn-primary w-100" (click)="viewAdDetails(ad.id)">
                                            <i class="fa-solid fa-eye me-2"></i>
                                            View Details
                                        </button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <ng-template #noAds>
            <div *ngIf="!isLoading" class="text-center py-5 text-muted">
                <div class="mb-3">
                    <i class="fa-solid fa-inbox fa-3x"></i>
                </div>
                <h5 class="mb-2">No {{categoryName}} Listings Available</h5>
                <p class="mb-0">Be the first to post a {{categoryName.toLowerCase()}} advertisement!</p>
            </div>
        </ng-template>

    </div>

    <!-- Pagination -->
    <div *ngIf="!isLoading && totalPages > 1" class="d-flex justify-content-center mt-4">
        <nav>
            <ul class="pagination">
                <li class="page-item" [class.disabled]="page === 1">
                    <button class="page-link" (click)="prevPage()">Previous</button>
                </li>

                <li class="page-item" *ngFor="let p of getPageNumbers()" [class.active]="page === p">
                    <button class="page-link" (click)="goToPage(p)">
                        {{ p }}
                    </button>
                </li>

                <li class="page-item" [class.disabled]="page === totalPages">
                    <button class="page-link" (click)="nextPage()">Next</button>
                </li>
            </ul>
        </nav>
    </div>


</section>